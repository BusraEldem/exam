# -------------------------------------------------------------------------- ###
# Question 1a ----

https://github.com/BusraEldem/exam
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 2a ----
library(dplyr)

average_fare_by_sex <- titanic %>%
  group_by(sex) %>%
  summarise(average_fare = mean(fare, na.rm = TRUE))

average_fare_by_sex

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 2b ----

library(tidyverse)


filtered_data <- titanic %>%
  filter(!is.na(age))


ggplot(filtered_data, aes(x = sex, y = age)) +
  geom_boxplot() +
  xlab("Sex") +
  ylab("Age") +
  ggtitle("Boxplot of Ages by Sex")

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 2c ----

library(ggplot2)


age_breaks <- c(0, 20, 40, 60, 80)


ggplot(titanic, aes(x = age)) +
  geom_histogram(aes(y = ..density..), bins = age_breaks, color = "black", fill = "lightpink") +
  scale_x_continuous(breaks = age_breaks) +
  scale_y_continuous(breaks = c(0.00, 0.01, 0.02, 0.03, 0.04)) +
  xlab("Age") +
  ylab("Density") +
  ggtitle("Histogram of Age with Density")

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3a ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3b ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3c ----

library(ggplot2)


data <- data.frame(
  x = c(-0.5, 0, 0.5, 1),
  y = c(17.5, 20, 22.5, 25)
)


plot <- ggplot(data, aes(x = x, y = y)) +
  geom_point(shape = 16, size = 3) +  
  scale_y_continuous(breaks = c(17.5, 20, 22.5, 25, 27.5)) 

print(plot)

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3d ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3e ----

n <- 25     
mean_X <- 0   
sd_X <- 1     


X_bar <- rnorm(n, mean_X, sd_X)
S <- sd(X_bar)


Z <- 5 * (mean(X_bar) - mean_X) / S


P_Z_leq_1 <- pnorm(1, 0, 1)


print(P_Z_leq_1)

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3f ----

roll_dice <- function() {
  dice <- sample(1:6, 2, replace = TRUE)  
  sum_dice <- sum(dice)                   
  
  
  cat("Dice 1:", dice[1], "\n")
  cat("Dice 2:", dice[2], "\n")
  cat("Sum:", sum_dice, "\n")
  
  return(sum_dice)  
}

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 3g ----
# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 4a ----

library(dplyr)

dat2 <- dat %>%
  group_by(country) %>%
  summarise(gdp_pc = gdp / population) %>%
  select(country, year, gdp, population, gdp_pc)

# -------------------------------------------------------------------------- ###


# -------------------------------------------------------------------------- ###
# Question 5a ----

library(tidyr)

dat2 <- dat %>%
  pivot_longer(cols = -country, names_to = "year", values_to = "gdp") %>%
  arrange(country, year)

# -------------------------------------------------------------------------- ###